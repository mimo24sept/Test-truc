<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Roulette Royale</title>
  <style>
    :root {
      --felt: linear-gradient(135deg, #0f5132 0%, #0c3826 60%, #0f5132 100%);
      --card: rgba(8, 26, 20, 0.8);
      --gold: #d8b55c;
      --shadow: rgba(0, 0, 0, 0.35);
      --text: #f4f1e6;
      --muted: #9fb2a5;
      --chip-red: #e74c3c;
      --chip-black: #1a1a1a;
      --chip-green: #2ecc71;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at 20% 20%, rgba(216, 181, 92, 0.15), transparent 35%),
                  radial-gradient(circle at 80% 0%, rgba(216, 181, 92, 0.12), transparent 30%),
                  var(--felt);
      color: var(--text);
      font-family: 'Bodoni MT', 'Didot', 'Palatino', serif;
    }

    .layout {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 18px;
      padding: 26px;
    }

    .panel {
      background: var(--card);
      border: 1px solid rgba(216, 181, 92, 0.35);
      border-radius: 18px;
      padding: 20px;
      box-shadow: 0 16px 40px var(--shadow);
      backdrop-filter: blur(4px);
      position: relative;
      overflow: hidden;
    }

    .panel::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 30% 30%, rgba(216, 181, 92, 0.08), transparent 35%),
                  radial-gradient(circle at 80% 50%, rgba(216, 181, 92, 0.06), transparent 30%);
      pointer-events: none;
    }

    h1, h2 { margin: 0; letter-spacing: 0.08em; }
    h1 { font-size: 1.85rem; }
    h2 { font-size: 1.2rem; }

    .table-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      position: relative;
      z-index: 1;
    }

    .credits {
      font-size: 1.1rem;
      background: rgba(12, 56, 38, 0.7);
      border: 1px solid rgba(216, 181, 92, 0.35);
      padding: 10px 16px;
      border-radius: 12px;
      box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.25);
    }

    .status {
      background: rgba(12, 56, 38, 0.85);
      border: 1px solid rgba(216, 181, 92, 0.25);
      border-radius: 12px;
      padding: 12px 14px;
      margin-bottom: 14px;
      min-height: 52px;
      display: flex;
      align-items: center;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .status .indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      box-shadow: 0 0 0 2px rgba(0,0,0,0.2);
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
      margin-bottom: 16px;
      position: relative;
      z-index: 1;
    }

    .control {
      background: rgba(0, 0, 0, 0.25);
      border: 1px solid rgba(216, 181, 92, 0.25);
      padding: 12px;
      border-radius: 12px;
      display: grid;
      gap: 8px;
    }

    label {
      color: var(--muted);
      font-size: 0.9rem;
      letter-spacing: 0.03em;
    }

    input {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(216, 181, 92, 0.3);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 10px;
      font-size: 1rem;
      width: 100%;
    }

    .palette {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .chip-btn {
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      font-weight: 700;
      color: #0b0b0b;
      cursor: pointer;
      box-shadow: 0 8px 14px rgba(0,0,0,0.35), inset 0 -4px 0 rgba(0,0,0,0.25);
      transition: transform 0.08s ease, box-shadow 0.1s ease, border 0.15s ease;
    }

    .chip-btn[data-color="red"] { background: linear-gradient(145deg, #e44636, #9f1f14); color: #f8f8f8; }
    .chip-btn[data-color="black"] { background: linear-gradient(145deg, #222, #0b0b0b); color: #f8f8f8; }
    .chip-btn[data-color="green"] { background: linear-gradient(145deg, #2fc485, #0f6b46); color: #0b0b0b; }
    .chip-btn.active { transform: translateY(-2px); border: 1px solid rgba(216, 181, 92, 0.75); }

    .actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
      margin-top: 4px;
    }

    button.primary, button.ghost {
      border: none;
      border-radius: 12px;
      padding: 12px 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.12s ease;
    }
    button:active { transform: translateY(1px); }
    button.primary {
      background: linear-gradient(135deg, #f0d782, #d6b54b);
      box-shadow: 0 10px 18px rgba(216, 181, 92, 0.35);
      color: #0b0b0b;
    }
    button.ghost {
      background: rgba(255,255,255,0.08);
      color: var(--text);
      border: 1px solid rgba(216, 181, 92, 0.3);
      box-shadow: 0 10px 18px rgba(0,0,0,0.35);
    }

    .stage {
      display: grid;
      grid-template-columns: 1.1fr 1fr;
      gap: 14px;
      align-items: center;
      position: relative;
      z-index: 1;
    }

    .wheel-wrap {
      background: radial-gradient(circle at 50% 40%, rgba(216, 181, 92, 0.12), rgba(0,0,0,0.35));
      border-radius: 50%;
      padding: 14px;
      display: grid;
      place-items: center;
      box-shadow: inset 0 0 20px rgba(0,0,0,0.35), 0 12px 24px rgba(0,0,0,0.35);
      position: relative;
    }

    .wheel {
      width: 280px;
      height: 280px;
      border-radius: 50%;
      position: relative;
      box-shadow: inset 0 0 24px rgba(0,0,0,0.45);
      transition: transform 2.6s cubic-bezier(0.25, 0.9, 0.4, 1);
    }

    .wheel::after {
      content: "";
      position: absolute;
      inset: 18%;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(0,0,0,0.3), rgba(0,0,0,0.75));
      box-shadow: inset 0 0 8px rgba(0,0,0,0.45);
    }

    .slots {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      pointer-events: none;
    }

    .slot {
      position: absolute;
      top: 50%;
      left: 50%;
      transform-origin: center;
      font-size: 0.7rem;
      font-weight: 800;
      padding: 2px 4px;
      border-radius: 8px;
      min-width: 22px;
      text-align: center;
      letter-spacing: 0.02em;
      background: rgba(0, 0, 0, 0.78);
      color: #fefefe;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow:
        0 2px 8px rgba(0, 0, 0, 0.55),
        0 0 0 2px rgba(0, 0, 0, 0.35);
      text-shadow:
        0 0 8px rgba(0,0,0,0.7),
        0 2px 6px rgba(0,0,0,0.65),
        0 -1px 2px rgba(255,255,255,0.18);
    }

    .pin {
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      width: 18px;
      height: 36px;
      background: linear-gradient(180deg, #f5e7b1, #b9862c);
      clip-path: polygon(50% 100%, 0% 0%, 100% 0%);
      box-shadow: 0 6px 14px rgba(0,0,0,0.45);
      z-index: 2;
    }

    .outcome {
      background: rgba(0,0,0,0.35);
      border: 1px solid rgba(216, 181, 92, 0.3);
      border-radius: 12px;
      padding: 14px;
      min-height: 140px;
      display: grid;
      gap: 8px;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.35);
    }

    .badge {
      display: inline-block;
      padding: 6px 10px;
      border-radius: 10px;
      font-weight: 700;
      font-size: 0.95rem;
      border: 1px solid rgba(255,255,255,0.12);
    }
    .badge.red { background: rgba(228, 70, 54, 0.22); color: #f7c5bf; }
    .badge.black { background: rgba(0,0,0,0.35); color: #dcdcdc; }
    .badge.green { background: rgba(47, 196, 133, 0.25); color: #c9f1de; }

    .felt-card { margin-top: 14px; position: relative; z-index: 1; }
    .felt-card h2 { margin-bottom: 8px; }

    .bet-grid {
      display: grid;
      grid-template-columns: 1.1fr repeat(12, 1fr);
      grid-template-rows: repeat(3, 68px);
      gap: 2px;
      background: rgba(0,0,0,0.3);
      padding: 6px;
      border-radius: 14px;
      border: 1px solid rgba(216,181,92,0.2);
      position: relative;
    }

    .cell {
      background: rgba(8, 26, 20, 0.75);
      border: 1px solid rgba(216, 181, 92, 0.15);
      border-radius: 10px;
      display: grid;
      place-items: center;
      font-weight: 700;
      color: #f6f6f6;
      position: relative;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.1s ease, border 0.1s ease;
      overflow: hidden;
    }

    .cell:hover { border-color: rgba(216, 181, 92, 0.45); transform: translateY(-1px); }
    .cell.selected { box-shadow: 0 0 0 2px rgba(216,181,92,0.5); }
    .cell.red { background: linear-gradient(145deg, rgba(228, 70, 54, 0.35), rgba(228, 70, 54, 0.18)); }
    .cell.black { background: linear-gradient(145deg, rgba(0,0,0,0.55), rgba(0,0,0,0.35)); }
    .cell.green { background: linear-gradient(145deg, rgba(47, 196, 133, 0.35), rgba(47, 196, 133, 0.2)); color: #0b0b0b; }
    .cell.zero { grid-row: 1 / span 3; font-size: 1.2rem; }

    .chip-token {
      position: absolute;
      inset: 0;
      margin: auto;
      width: 58px;
      height: 58px;
      border-radius: 50%;
      background: linear-gradient(145deg, #f0d782, #d6b54b);
      color: #0b0b0b;
      display: grid;
      place-items: center;
      font-weight: 800;
      box-shadow: 0 10px 16px rgba(0,0,0,0.4), inset 0 -4px 0 rgba(0,0,0,0.25);
      pointer-events: none;
      animation: drop 0.22s ease-out;
    }

    @keyframes drop { from { transform: translateY(-12px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

    .color-bets {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      margin-top: 10px;
    }

    .color-spot {
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(216,181,92,0.25);
      font-weight: 700;
      cursor: pointer;
      text-align: center;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.25);
      transition: transform 0.08s ease, box-shadow 0.1s ease, border 0.1s ease;
      color: #f8f8f8;
      position: relative;
      overflow: hidden;
    }

    .color-spot.red { background: linear-gradient(145deg, #e44636, #9f1f14); }
    .color-spot.black { background: linear-gradient(145deg, #222, #0b0b0b); }
    .color-spot.green { background: linear-gradient(145deg, #2fc485, #0f6b46); color: #0b0b0b; }
    .color-spot.selected { box-shadow: 0 0 0 2px rgba(216,181,92,0.55); transform: translateY(-1px); }

    .history-list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 10px;
      max-height: 720px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .history-item {
      background: rgba(0,0,0,0.2);
      border: 1px solid rgba(216, 181, 92, 0.25);
      border-radius: 12px;
      padding: 10px 12px;
      display: grid;
      grid-template-columns: auto 1fr auto;
      gap: 10px;
      align-items: center;
    }

    .pip { width: 10px; height: 10px; border-radius: 50%; }
    .small { color: var(--muted); font-size: 0.92rem; }

    .selection-label {
      color: var(--muted);
      font-size: 0.95rem;
      display: flex;
      gap: 6px;
      align-items: center;
      flex-wrap: wrap;
    }

    .selection-label strong { color: var(--text); }

    @media (max-width: 1100px) {
      .layout { grid-template-columns: 1fr; }
      .stage { grid-template-columns: 1fr; }
      .wheel { width: 240px; height: 240px; }
    }
  </style>
</head>
<body>
  <div class="layout">
    <section class="panel">
      <div class="table-head">
        <h1>Roulette Royale</h1>
        <div class="credits" id="credits">Crédits : 10 000</div>
      </div>

      <div class="status" id="status">
        <div class="indicator" id="status-indicator" style="background:#888;"></div>
        <div id="status-text">Choisissez un numéro ou une couleur, placez des jetons puis lancez.</div>
      </div>

      <div class="controls">
        <div class="control">
          <label for="bet-amount">Montant de la mise</label>
          <input id="bet-amount" type="number" min="1" value="100">
          <div class="palette">
            <button class="chip-btn" data-chip-value="50" data-color="green">50</button>
            <button class="chip-btn" data-chip-value="100" data-color="red">100</button>
            <button class="chip-btn" data-chip-value="500" data-color="black">500</button>
            <button class="chip-btn" data-chip-value="1000" data-color="red">1000</button>
            <button class="chip-btn" data-chip-value="5000" data-color="black">5000</button>
          </div>
          <div class="selection-label">
            Cible : <strong id="selected-label">aucune</strong>
          </div>
        </div>
        <div class="control">
          <label>Actions</label>
          <div class="actions">
            <button class="primary" id="spin">Lancer la roue</button>
            <button class="ghost" id="all-in">All-in</button>
            <button class="ghost" id="reset">Reset à 10 000</button>
          </div>
        </div>
      </div>

      <div class="stage">
        <div class="wheel-wrap">
          <div class="pin"></div>
          <div class="wheel" id="wheel">
            <div class="slots" id="wheel-numbers"></div>
          </div>
        </div>
        <div class="outcome">
          <div class="small">Dernier résultat</div>
          <div id="outcome-number" class="badge black">-</div>
          <div id="outcome-summary" class="small">En attente...</div>
        </div>
      </div>

      <div class="felt-card">
        <h2>Tapis des mises</h2>
        <div class="bet-grid" id="bet-table"></div>
        <div class="color-bets">
          <div class="color-spot red" data-color-target="red" data-spot="color-red">Rouge x2</div>
          <div class="color-spot black" data-color-target="black" data-spot="color-black">Noir x2</div>
          <div class="color-spot green" data-color-target="green" data-spot="color-green">Zéro x14</div>
        </div>
      </div>
    </section>

    <aside class="panel">
      <h2>Historique</h2>
      <ul class="history-list" id="history-list"></ul>
    </aside>
  </div>

  <script>
    const redNumbers = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
    const wheelOrder = [0,32,15,19,4,21,2,25,17,34,6,27,13,36,11,30,8,23,10,5,24,16,33,1,20,14,31,9,22,18,29,7,28,12,35,3,26];
    const slotAngle = 360 / wheelOrder.length;
    const pointerOffset = -slotAngle / 2; // centre d'une case aligné sur la flèche (12h)

    const creditsEl = document.getElementById('credits');
    const betAmountEl = document.getElementById('bet-amount');
    const statusText = document.getElementById('status-text');
    const statusIndicator = document.getElementById('status-indicator');
    const wheel = document.getElementById('wheel');
    const wheelNumbers = document.getElementById('wheel-numbers');
    const outcomeNumber = document.getElementById('outcome-number');
    const outcomeSummary = document.getElementById('outcome-summary');
    const historyList = document.getElementById('history-list');
    const betTable = document.getElementById('bet-table');
    const selectedLabel = document.getElementById('selected-label');
    const colorSpots = Array.from(document.querySelectorAll('[data-color-target]'));
    const chipButtons = Array.from(document.querySelectorAll('[data-chip-value]'));

    let credits = 10000;
    const bets = new Map(); // key: spot id, value: {type,value,amount,label}
    const chipsOnTable = new Map(); // spot -> chip element
    let spinning = false;

    const formatCredits = (value) => value.toLocaleString('fr-FR');

    const getColor = (number) => {
      if (number === 0) return 'green';
      return redNumbers.includes(number) ? 'red' : 'black';
    };

    const setStatus = (text, color) => {
      statusText.textContent = text;
      statusIndicator.style.background = color;
    };

    const updateCredits = () => {
      creditsEl.textContent = `Crédits : ${formatCredits(credits)}`;
    };

    const updateSelectionLabel = () => {
      const totalBets = Array.from(bets.values()).reduce((sum, b) => sum + b.amount, 0);
      if (bets.size === 0) {
        selectedLabel.textContent = 'aucune';
      } else {
        selectedLabel.textContent = `${bets.size} mise(s) • total ${formatCredits(totalBets)} cr.`;
      }
    };

    const removeChip = (spotId) => {
      const chip = chipsOnTable.get(spotId);
      if (chip?.parentElement) {
        chip.parentElement.classList.remove('selected');
        chip.remove();
      }
      chipsOnTable.delete(spotId);
    };

    const placeChip = (spotId, amount) => {
      const target = document.querySelector(`[data-spot="${spotId}"]`);
      if (!target) return;
      removeChip(spotId);
      target.classList.add('selected');
      const chip = document.createElement('div');
      chip.className = 'chip-token';
      chip.textContent = amount.toLocaleString('fr-FR');
      target.appendChild(chip);
      chipsOnTable.set(spotId, chip);
    };

    const upsertBet = (bet) => {
      const spotId = `${bet.type}-${bet.value}`;
      bets.set(spotId, { ...bet });
      placeChip(spotId, bet.amount);
      colorSpots.forEach(spot => {
        const active = bets.has(`color-${spot.dataset.colorTarget}`);
        spot.classList.toggle('selected', active);
      });
      updateSelectionLabel();
    };

    const clearAllBets = () => {
      bets.clear();
      Array.from(chipsOnTable.keys()).forEach(removeChip);
      colorSpots.forEach(spot => spot.classList.remove('selected'));
      updateSelectionLabel();
    };

    const buildTable = () => {
      const zero = document.createElement('div');
      zero.className = 'cell green zero';
      zero.textContent = '0';
      zero.dataset.spot = 'number-0';
      zero.style.gridRow = '1 / span 3';
      zero.style.gridColumn = '1';
      betTable.appendChild(zero);

      let column = 2;
      for (let i = 0; i < 12; i++) {
        const top = 3 + i * 3;
        const middle = 2 + i * 3;
        const bottom = 1 + i * 3;
        const cells = [
          { n: top, row: 1 },
          { n: middle, row: 2 },
          { n: bottom, row: 3 },
        ];
        cells.forEach(({ n, row }) => {
          const cell = document.createElement('div');
          const color = getColor(n);
          cell.className = `cell ${color}`;
          cell.textContent = n;
          cell.dataset.spot = `number-${n}`;
          cell.style.gridColumn = `${column}`;
          cell.style.gridRow = `${row}`;
          betTable.appendChild(cell);
        });
        column += 1;
      }
    };

    const pointerOffset = 0; // 0° = flèche à 12h

    const buildWheel = () => {
      const segments = wheelOrder.map((num, i) => {
        const start = i * slotAngle + pointerOffset;
        const end = start + slotAngle;
        const color = getColor(num);
        const hex = color === 'red' ? '#e44636' : color === 'black' ? '#101010' : '#2fc485';
        return `${hex} ${start}deg ${end}deg`;
      }).join(', ');
      wheel.style.background = `conic-gradient(from ${pointerOffset}deg, ${segments})`;

      wheelNumbers.innerHTML = '';
      const radius = wheel.clientWidth / 2 - 20;
      wheelOrder.forEach((num, i) => {
        const marker = document.createElement('div');
        const color = getColor(num);
        marker.className = `slot ${color}`;
        const angle = i * slotAngle; // centre de case aligné à 12h
        marker.style.transform = `translate(-50%, -50%) rotate(${angle}deg) translateY(-${radius}px) rotate(${-angle}deg)`;
        marker.textContent = num;
        wheelNumbers.appendChild(marker);
      });
    };

    const addHistory = ({ number, color, bet, win, creditsLeft, betLabel }) => {
      const item = document.createElement('li');
      item.className = 'history-item';

      const pip = document.createElement('div');
      pip.className = 'pip';
      pip.style.background = color === 'red' ? '#e44636' : color === 'black' ? '#0b0b0b' : '#2fc485';

      const desc = document.createElement('div');
      desc.innerHTML = `<strong>${number}</strong> (${color}) • ${betLabel}`;

      const gain = document.createElement('div');
      const sign = win >= 0 ? '+' : '-';
      gain.textContent = `${sign}${Math.abs(win).toLocaleString('fr-FR')} cr.`;
      gain.style.color = win >= 0 ? '#d8b55c' : '#f28585';
      gain.title = `Solde: ${formatCredits(creditsLeft)}`;

      item.append(pip, desc, gain);
      historyList.prepend(item);
    };

    const spinWheel = () => {
      if (spinning) return;

      if (bets.size === 0) {
        setStatus('Placez au moins une mise.', '#f28585');
        return;
      }

      const totalBet = Array.from(bets.values()).reduce((sum, b) => sum + b.amount, 0);
      if (!Number.isFinite(totalBet) || totalBet <= 0) {
        setStatus('Montant de mise invalide.', '#f28585');
        return;
      }
      if (totalBet > credits) {
        setStatus('Pas assez de crédits pour ces mises.', '#f28585');
        return;
      }

      credits -= totalBet;
      updateCredits();

      spinning = true;
      setStatus('La roue tourne...', '#d8b55c');

      const number = Math.floor(Math.random() * 37);
      const color = getColor(number);
      const targetIndex = wheelOrder.indexOf(number);
      const targetAngle = targetIndex * slotAngle; // centre de case
      const fullSpins = 3 + Math.floor(Math.random() * 3); // 3,4,5 tours
      const finalRotation = -(fullSpins * 360 + targetAngle); // rotation anti-horaire pour amener la case sous la flèche
      wheel.style.transform = `rotate(${finalRotation}deg)`;

      setTimeout(() => {
        let payout = 0;
        bets.forEach(bet => {
          if (bet.type === 'number' && bet.value === number) payout += bet.amount * 36;
          if (bet.type === 'color' && bet.value === color) {
            payout += bet.amount * (color === 'green' ? 14 : 2);
          }
        });

        credits += payout;
        updateCredits();

        const net = payout - totalBet;
        const gainText = net >= 0
          ? `Vous gagnez ${formatCredits(net)} crédits !`
          : `Perdu ${formatCredits(Math.abs(net))} crédits.`;
        setStatus(`${gainText} Résultat: ${number} (${color}).`, net >= 0 ? '#d8b55c' : '#f28585');

        outcomeNumber.textContent = number;
        outcomeNumber.className = `badge ${color}`;
        outcomeSummary.textContent = `${color === 'green' ? 'Zéro' : 'Couleur ' + color} • ${bets.size} mise(s)`;

        addHistory({
          number,
          color,
          bet: totalBet,
          win: net,
          creditsLeft: credits,
          betLabel: `${bets.size} mise(s) • total ${formatCredits(totalBet)}`
        });

        clearAllBets();
        spinning = false;
      }, 2600);
    };

    const resetGame = () => {
      credits = 10000;
      updateCredits();
      historyList.innerHTML = '';
      setStatus('Crédits remis à 10 000. Placez votre mise.', '#d8b55c');
      outcomeNumber.textContent = '-';
      outcomeNumber.className = 'badge black';
      outcomeSummary.textContent = 'En attente...';
      wheel.style.transform = 'rotate(0deg)';
      clearAllBets();
      spinning = false;
    };

    const handleCellClick = (event) => {
      const spot = event.target.closest('.cell');
      if (!spot) return;
      const amount = Number(betAmountEl.value);
      if (!Number.isFinite(amount) || amount <= 0) {
        setStatus('Entrez un montant valide avant de placer un jeton.', '#f28585');
        return;
      }
      const [type, value] = spot.dataset.spot.split('-');
      upsertBet({ type, value: Number(value), amount, label: `Numéro ${value}` });
    };

    const handleColorClick = (event) => {
      const spot = event.currentTarget;
      const amount = Number(betAmountEl.value);
      if (!Number.isFinite(amount) || amount <= 0) {
        setStatus('Entrez un montant valide avant de placer un jeton.', '#f28585');
        return;
      }
      const color = spot.dataset.colorTarget;
      upsertBet({ type: 'color', value: color, amount, label: `Couleur ${color}` });
    };

    const handleChipButton = (event) => {
      chipButtons.forEach(btn => btn.classList.remove('active'));
      const btn = event.currentTarget;
      btn.classList.add('active');
      const value = Number(btn.dataset.chipValue);
      betAmountEl.value = value;
    };

    document.getElementById('spin').addEventListener('click', spinWheel);
    document.getElementById('reset').addEventListener('click', resetGame);
    document.getElementById('all-in').addEventListener('click', () => {
      betAmountEl.value = credits;
      setStatus('All-in sélectionné : cliquez sur les cases voulues.', '#d8b55c');
    });

    betTable.addEventListener('click', handleCellClick);
    colorSpots.forEach(spot => spot.addEventListener('click', handleColorClick));
    chipButtons.forEach(btn => btn.addEventListener('click', handleChipButton));

    buildTable();
    buildWheel();
    setStatus('Choisissez un numéro ou une couleur, placez des jetons puis lancez.', '#888');
    updateCredits();
  </script>
</body>
</html>
